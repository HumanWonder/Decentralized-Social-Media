{"ast":null,"code":"var _jsxFileName = \"/home/student/Bureau/m\\xE9ta/Decentralized-Social-Media/src/componante/FormMakePost.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport ImageSendToApi from \"../utils/ImgToApi\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst FormMakePost = ({\n  onSubmit\n}) => {\n  _s();\n  const [postTitle, setPostTitle] = useState(\"\");\n  const [postText, setPostText] = useState(\"\");\n  const [base64Img, setBase64Img] = useState(\"\");\n  const [fileName, setFileName] = useState(\"\");\n  const [imgUrl, setImgUrl] = useState(\"\");\n  const handleSubmit = e => {\n    e.preventDefault();\n    const uuid = uuidv4();\n    const date = new Date().toLocaleDateString('fr-FR');\n    if (fileName !== '') {\n      ImageSendToApi(fileName, base64Img, date).then(response => {\n        if (response['Error']) {\n          let error = response['Error'];\n          console.error(\"Error sending image: \", error);\n          alert(\"Error sending image: \", error);\n          return;\n        }\n        setImgUrl(response);\n        const formData = {\n          uuid: uuid,\n          postTitle: postTitle,\n          postText: postText,\n          postImg: base64Img,\n          imgUrl: response['Link']\n        };\n        console.log(\"Form data: \", formData);\n        console.log(fileName);\n        onSubmit(formData);\n      }).catch(error => {\n        console.error(\"Error sending image:\", error);\n      }).finally(() => {\n        setPostTitle(\"\");\n        setPostText(\"\");\n        setBase64Img(\"\");\n        setFileName(\"\");\n        setImgUrl(\"\");\n      });\n    } else {\n      const formData = {\n        uuid: uuid,\n        postTitle: postTitle,\n        postText: postText,\n        postImg: null,\n        imgUrl: null\n      };\n      console.log(\"Form data: \", formData);\n      console.log(fileName);\n      onSubmit(formData);\n      setPostTitle(\"\");\n      setPostText(\"\");\n      setBase64Img(\"\");\n      setFileName(\"\");\n      setImgUrl(\"\");\n    }\n    ;\n  };\n  const handleFileChange = e => {\n    const file = e.target.files[0];\n    if (file) {\n      const maxSize = 2 * 1024 * 1024;\n      if (file.size > maxSize) {\n        alert(`La taille du fichier dépasse la limite de ${maxSize / 1024 / 1024} Mo.`);\n        e.target.value = null;\n        return;\n      }\n      const allowedTypes = [\"image/jpeg\", \"image/png\"];\n      if (!allowedTypes.includes(file.type)) {\n        alert(\"Veuillez sélectionner un fichier image valide (JPEG, PNG).\");\n        e.target.value = null;\n        return;\n      }\n      const uuid = uuidv4();\n      setFileName(`${uuid}.${file.type.slice(6)}`);\n      const reader = new FileReader();\n      reader.onloadend = () => {\n        setBase64Img(reader.result);\n      };\n      reader.readAsDataURL(file);\n    }\n  };\n  useEffect(() => {\n    console.log(\"Image URL:\", imgUrl);\n  }, [imgUrl]);\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    onSubmit: handleSubmit,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"postTitle\",\n        className: \"form-label\",\n        children: \"Title*:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        className: \"form-control\",\n        id: \"postTitle\",\n        name: \"postTitle\",\n        value: postTitle,\n        onChange: e => setPostTitle(e.target.value),\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"postText\",\n        className: \"form-label\",\n        children: \"Text*:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 119,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n        className: \"form-control\",\n        id: \"postText\",\n        name: \"postText\",\n        value: postText,\n        onChange: e => setPostText(e.target.value),\n        required: true\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 122,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 118,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [/*#__PURE__*/_jsxDEV(\"label\", {\n        htmlFor: \"formFile\",\n        className: \"form-label\",\n        children: \"Default file input example\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n        className: \"form-control\",\n        type: \"file\",\n        id: \"formFile\",\n        onChange: handleFileChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"help\",\n      className: \"form-text mb-3\",\n      children: \"Les champs avec une * sont requis\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n      type: \"submit\",\n      className: \"btn btn-primary\",\n      children: \"Submit\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 103,\n    columnNumber: 5\n  }, this);\n};\n_s(FormMakePost, \"KQESVYUChgFM1x5tiI19m8x7R8Q=\");\n_c = FormMakePost;\nexport default FormMakePost;\nvar _c;\n$RefreshReg$(_c, \"FormMakePost\");","map":{"version":3,"names":["React","useState","useEffect","v4","uuidv4","ImageSendToApi","jsxDEV","_jsxDEV","FormMakePost","onSubmit","_s","postTitle","setPostTitle","postText","setPostText","base64Img","setBase64Img","fileName","setFileName","imgUrl","setImgUrl","handleSubmit","e","preventDefault","uuid","date","Date","toLocaleDateString","then","response","error","console","alert","formData","postImg","log","catch","finally","handleFileChange","file","target","files","maxSize","size","value","allowedTypes","includes","type","slice","reader","FileReader","onloadend","result","readAsDataURL","children","className","htmlFor","_jsxFileName","lineNumber","columnNumber","id","name","onChange","required","_c","$RefreshReg$"],"sources":["/home/student/Bureau/méta/Decentralized-Social-Media/src/componante/FormMakePost.js"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { v4 as uuidv4 } from \"uuid\";\nimport ImageSendToApi from \"../utils/ImgToApi\";\n\nconst FormMakePost = ({ onSubmit }) => {\n  const [postTitle, setPostTitle] = useState(\"\");\n  const [postText, setPostText] = useState(\"\");\n  const [base64Img, setBase64Img] = useState(\"\");\n  const [fileName, setFileName] = useState(\"\");\n  const [imgUrl, setImgUrl] = useState(\"\");\n\n  const handleSubmit = (e) => {\n    e.preventDefault();\n\n    const uuid = uuidv4();\n    const date = new Date().toLocaleDateString('fr-FR');\n\n    if (fileName !== '') {\n      ImageSendToApi(fileName, base64Img, date)\n      .then((response) => {\n        if (response['Error']) {\n          let error = response['Error'];\n          console.error(\"Error sending image: \", error);\n          alert(\"Error sending image: \", error);\n          return\n        }\n        setImgUrl(response);\n        const formData = {\n          uuid: uuid,\n          postTitle: postTitle,\n          postText: postText,\n          postImg: base64Img,\n          imgUrl: response['Link']\n        };\n        console.log(\"Form data: \", formData);\n        console.log(fileName);\n        onSubmit(formData);\n      })\n      .catch((error) => {\n        console.error(\"Error sending image:\", error);\n      })\n      .finally(() => {\n        setPostTitle(\"\");\n        setPostText(\"\");\n        setBase64Img(\"\");\n        setFileName(\"\");\n        setImgUrl(\"\");\n      });\n      }else{\n        const formData = {\n          uuid: uuid,\n          postTitle: postTitle,\n          postText: postText,\n          postImg: null,\n          imgUrl: null\n        };\n        console.log(\"Form data: \", formData);\n        console.log(fileName);\n        onSubmit(formData);\n\n        setPostTitle(\"\");\n        setPostText(\"\");\n        setBase64Img(\"\");\n        setFileName(\"\");\n        setImgUrl(\"\");\n      };\n    }\n\n    const handleFileChange = (e) => {\n      const file = e.target.files[0];\n    \n      if (file) {\n        const maxSize = 2 * 1024 * 1024;\n        if (file.size > maxSize) {\n          alert(`La taille du fichier dépasse la limite de ${maxSize / 1024 / 1024} Mo.`);\n          e.target.value = null;\n          return;\n        }\n    \n        const allowedTypes = [\"image/jpeg\", \"image/png\"];\n        if (!allowedTypes.includes(file.type)) {\n          alert(\"Veuillez sélectionner un fichier image valide (JPEG, PNG).\");\n          e.target.value = null;\n          return;\n        }\n    \n        const uuid = uuidv4();\n        setFileName(`${uuid}.${file.type.slice(6)}`);\n    \n        const reader = new FileReader();\n        reader.onloadend = () => {\n          setBase64Img(reader.result);\n        };\n        reader.readAsDataURL(file);\n      }\n    };\n\n  useEffect(() => {\n    console.log(\"Image URL:\", imgUrl);\n  }, [imgUrl]);\n\n  return (\n    <form onSubmit={handleSubmit}>\n      <div className=\"mb-3\">\n        <label htmlFor=\"postTitle\" className=\"form-label\">\n          Title*:\n        </label>\n        <input\n          type=\"text\"\n          className=\"form-control\"\n          id=\"postTitle\"\n          name=\"postTitle\"\n          value={postTitle}\n          onChange={(e) => setPostTitle(e.target.value)}\n          required\n        />\n      </div>\n      <div className=\"mb-3\">\n        <label htmlFor=\"postText\" className=\"form-label\">\n          Text*:\n        </label>\n        <textarea\n          className=\"form-control\"\n          id=\"postText\"\n          name=\"postText\"\n          value={postText}\n          onChange={(e) => setPostText(e.target.value)}\n          required\n        ></textarea>\n      </div>\n      <div>\n        <label htmlFor=\"formFile\" className=\"form-label\">\n          Default file input example\n        </label>\n        <input\n          className=\"form-control\"\n          type=\"file\"\n          id=\"formFile\"\n          onChange={handleFileChange}\n        />\n      </div>\n      <div id=\"help\" className=\"form-text mb-3\">\n        Les champs avec une * sont requis\n      </div>\n\n      <button type=\"submit\" className=\"btn btn-primary\">\n        Submit\n      </button>\n    </form>\n  );\n};\n\nexport default FormMakePost;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}